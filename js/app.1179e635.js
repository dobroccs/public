(function(){"use strict";var e={2968:function(e,a,t){t(4114);var l=t(5130),n=t(6768);function s(e,a){const t=(0,n.g2)("router-view");return(0,n.uX)(),(0,n.Wv)(t)}var u=t(1241);const o={},r=(0,u.A)(o,[["render",s]]);var i=r,c=t(1387);const d={class:"flex flex-col w-full flex-grow"};function m(e,a,t,l,s,u){const o=(0,n.g2)("CapacityTable");return(0,n.uX)(),(0,n.CE)("div",d,[(0,n.bF)(o)])}var v=t(4232),p=t(144),g=t(782);function y(e){const a=new Date(e,0,1),t=new Date(e,11,31),l=a.getDay(),n=t.getDay();return 1===l||0===l&&1===n||0===l&&0===n?53:52}var h=y;function f(e,a){const t=a-1;if(11===t){const a=new Date(e+1,0,0);return a.getDate()}{const a=new Date(e,t+1,0);return a.getDate()}}var b=f,w=t(4373);const k="http://109.74.128.91:64080",_={headers:{"Content-Type":"application/json"},withCredentials:!0},x={state:()=>({capacityData:void 0,scale:"week",month:(new Date).getMonth(),year:(new Date).getFullYear(),showInactiveUsers:!0}),mutations:{setScale(e,a){e.scale=a},setCapacityData(e,a){e.capacityData=a},setDate(e,a){e.year=a.year,e.month=a.month},setYear(e,a){e.year=a},setMonth(e,a){e.month=a},switchShowInactiveUsers(e){e.showInactiveUsers=!e.showInactiveUsers}},getters:{getCapacityData(e){return e.capacityData},getScale(e){return e.scale},getYear(e){return e.year},getMonth(e){return e.month},getByUserData(e){let a;a="week"===e.scale?h(e.year):"day"===e.scale?b(e.year,e.month):12;const t=new Map;for(const l of e.capacityData){t.has(l.userId)||!l.userActive&&!e.showInactiveUsers||t.set(l.userId,{teamName:l.teamName,userName:l.userName,userId:l.userId,teamId:l.teamId,userActive:l.userActive,data:Array(a).fill(null)});const n=t.get(l.userId);n&&("day"===e.scale?n.data[l.day-1]=l:"week"===e.scale?n.data[l.week-1]=l:n.data[l.month-1]=l)}return Array.from(t.values())},getTeamList(e){const a=new Map;return e.capacityData.forEach((e=>{a.has(e.teamId)||a.set(e.teamId,{teamId:e.teamId,teamName:e.teamName})})),Array.from(a.values())},getColumnCount(e){return"week"===e.scale?h(e.year):"day"===e.scale?b(e.year,e.month):12},getShowInactiveUsers(e){return e.showInactiveUsers}},actions:{async loadData({state:e,commit:a}){"week"===e.scale?a("setCapacityData",(await w.A.get(k+"/capacity_data/week/"+e.year+"/")).data):"month"===e.scale?a("setCapacityData",(await w.A.get(k+"/capacity_data/month/"+e.year+"/")).data):"day"===e.scale?a("setCapacityData",(await w.A.get(k+"/capacity_data/day/"+e.year+"/"+e.month+"/")).data):console.error("bad capacity data")},async nextPeriod({state:e,commit:a,dispatch:t}){"day"===e.scale?12==e.month?a("setDate",{year:e.year+1,month:1}):a("setMonth",e.month+1):"week"===e.scale||"month"===e.scale?a("setYear",e.year+1):console.error("wrong scale parameter"),await t("loadData")},async prevPeriod({state:e,commit:a,dispatch:t}){"day"===e.scale?1==e.month?a("setDate",{year:e.year-1,month:12}):a("setMonth",e.month-1):"week"===e.scale||"month"===e.scale?a("setYear",e.year-1):console.error("wrong scale parameter"),await t("loadData")},async nowPeriod({commit:e,dispatch:a}){e("setDate",{year:(new Date).getFullYear(),month:(new Date).getMonth()}),await a("loadData")}},namespaced:!0};var L=x;const C={state:()=>({timeMoneySwitcher:!0,percentsDigitsSwitcher:!0}),mutations:{switchTimeMoney(e){e.timeMoneySwitcher=!e.timeMoneySwitcher},switchPercentsDigits(e){e.percentsDigitsSwitcher=!e.percentsDigitsSwitcher}},getters:{getTimeMoney(e){return e.timeMoneySwitcher},getPercentsDigits(e){return e.percentsDigitsSwitcher}},actions:{},namespaced:!0};var D=C;const A={state:()=>({teamList:[],emptyAsanaUsersList:[]}),mutations:{setTeamList(e,a){e.teamList=a},setEmptyAsanaUsersList(e,a){e.emptyAsanaUsersList=a}},getters:{getTeamList(e){return e.teamList},getEmptyAsanaUsersList(e){return e.emptyAsanaUsersList}},actions:{async loadTeamList({state:e,commit:a}){const t=await w.A.get(+k+"/team/");a("setTeamList",t.data)},async loadEmptyAsanaUsersList({state:e,commit:a}){const t=await w.A.get(k+"/user/empty/");a("setEmptyAsanaUsersList",t.data)}},namespaced:!0};var R=A;const E={state:()=>({me:{is_active:!1,is_daemon:!1,email:null,phone:null,login:"",first_name:"",last_name:"",father_name:null,asana_gid:null,asana_name:null,asana_empty_user:!1,team_id:0,team_lead:!1,observer:!1,show_money:!1}}),mutations:{setMeData(e,a){e.me=a}},getters:{getMe(e){return e.me}},actions:{async loadMeData({state:e,commit:a}){e.me=await w.A.get(k+"/me/")}},namespaced:!0};var F=E,V=(0,g.y$)({modules:{capacityData:L,capacityRepresentation:D,userData:R,meData:F}});const M=[{month:"Январь",percent:9},{month:"Февраль",percent:8},{month:"Март",percent:9},{month:"Апрель",percent:8},{month:"Май",percent:9},{month:"Июнь",percent:8},{month:"Июль",percent:9},{month:"Август",percent:8},{month:"Сентябрь",percent:8},{month:"Октябрь",percent:8},{month:"Ноябрь",percent:8},{month:"Декабрь",percent:8}],I=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"];function W(e,a,t){const l=new Date(e,a-1,t),n=l.toLocaleString("ru",{weekday:"short"});return n.charAt(0).toUpperCase()+n.charAt(1).toLowerCase()}function U(e,a,t){const l=new Date(e,a-1,t),n=l.getDay();return 0===n||6===n}function K(e){return e<10?"0"+e.toString():e.toString()}var X=t(8390);const S={class:"grid content-center mt-2"};var T=(0,n.pM)({__name:"ScaleSelector",setup(e){const a=(0,n.EW)((()=>V.getters["capacityData/getScale"])),t=(0,p.KR)(a.value),l=(0,p.KR)([{label:"М",value:"month"},{label:"Н",value:"week"},{label:"Д",value:"day"}]);function s(){V.commit("capacityData/setScale",t.value),V.dispatch("capacityData/loadData")}return(e,a)=>((0,n.uX)(),(0,n.CE)("div",S,[(0,n.bF)((0,p.R1)(X.A),{allowEmpty:!1,class:"h-[40px] self-center",modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=e=>t.value=e),options:l.value,"option-value":"value","option-label":"label",onChange:a[1]||(a[1]=e=>s()),style:{outline:"none"}},null,8,["modelValue","options"])]))}});const N=T;var j=N,P=t(5531);const B={class:"flex w-fill mx-2 mt-2"};var O=(0,n.pM)({__name:"CapacityRepresentationSelectors",setup(e){function a(){console.log("here"),V.commit("capacityRepresentation/switchTimeMoney")}const t=(0,n.EW)((()=>V.getters["capacityRepresentation/getTimeMoney"]?"pi pi-clock":"pi pi-money-bill")),l=(0,n.EW)((()=>V.getters["capacityRepresentation/getPercentsDigits"]?"pi pi-percentage":"pi pi-box"));function s(){V.commit("capacityRepresentation/switchPercentsDigits")}const u=(0,n.EW)((()=>V.getters["capacityData/getShowInactiveUsers"]?"pi pi-users":"pi pi-user-minus"));function o(){V.commit("capacityData/switchShowInactiveUsers")}return(e,r)=>((0,n.uX)(),(0,n.CE)("div",B,[(0,p.R1)(V).getters["meData/getMe"].show_money?((0,n.uX)(),(0,n.Wv)((0,p.R1)(P.A),{key:0,icon:t.value,severity:"secondary",onClick:r[0]||(r[0]=e=>a())},null,8,["icon"])):(0,n.Q3)("",!0),(0,n.bF)((0,p.R1)(P.A),{icon:l.value,severity:"secondary",onClick:r[1]||(r[1]=e=>s())},null,8,["icon"]),(0,n.bF)((0,p.R1)(P.A),{icon:u.value,severity:"secondary",onClick:r[2]||(r[2]=e=>o())},null,8,["icon"])]))}});const Y=(0,u.A)(O,[["__scopeId","data-v-7e26c426"]]);var z=Y;const $={class:"flex w-fill mr-[31px]"};var Q=(0,n.pM)({__name:"CapacityDateNavBar",setup(e){function a(){V.dispatch("capacityData/prevPeriod")}function t(){V.dispatch("capacityData/nextPeriod")}function l(){V.dispatch("capacityData/nowPeriod")}const s=(0,n.EW)((()=>V.getters["capacityData/getYear"])),u=(0,n.EW)((()=>V.getters["capacityData/getMonth"])),o=(0,n.EW)((()=>V.getters["capacityData/getScale"])),r=(0,n.EW)((()=>"day"===o.value?I[u.value-1]+" "+s.value+"г.":"week"===o.value||"month"===o.value?s.value+" г.":(console.error("wrong scale parameter"),"")));return(e,s)=>((0,n.uX)(),(0,n.CE)("div",$,[(0,n.bF)((0,p.R1)(P.A),{icon:"pi pi-arrow-left","aria-label":"Предыдущий период",severity:"secondary",class:"h-[40px] self-center",onClick:s[0]||(s[0]=e=>a())}),(0,n.bF)((0,p.R1)(P.A),{severity:"secondary",label:r.value,class:"h-[40px] self-center",onClick:s[1]||(s[1]=e=>l())},null,8,["label"]),(0,n.bF)((0,p.R1)(P.A),{icon:"pi pi-arrow-right","aria-label":"Следующий период",severity:"secondary",class:"h-[40px] self-center",onClick:s[2]||(s[2]=e=>t())})]))}});const G=(0,u.A)(Q,[["__scopeId","data-v-79adde6a"]]);var H=G;const J={class:"flex flex-wrap max-w-fit bg-gray-100 pl-4 pt-2"},q={class:"flex grow justify-end"},Z=(0,n.Lk)("div",{class:"min-w-px max-w-px border-l border-gray-200 border-dotted ml-2 mt-2"},null,-1);var ee=(0,n.pM)({__name:"CapacityNavigation",setup(e){return(e,a)=>((0,n.uX)(),(0,n.CE)("div",J,[(0,n.bF)((0,p.R1)(P.A),{icon:"pi pi-bars","aria-label":"Filter",severity:"secondary"}),(0,n.Lk)("div",q,[(0,n.bF)(H)]),(0,n.bF)(j),Z,(0,n.bF)(z)]))}});const ae=ee;var te=ae;const le=e=>((0,n.Qi)("data-v-719f1398"),e=e(),(0,n.jt)(),e),ne={class:"flex my-table-header sticky top-0 z-10 text-black shadow h-full w-fit"},se={class:"my-blank bg-gray-100 sticky left-0 shadow rounded-r-xl"},ue={key:0,class:"bg-gray-100 rounded select-none font-normal"},oe={class:"my-ceil text-center"},re={class:"flex justify-center align-middle pt-2"},ie={class:"text-normal pt-3 pt text-gray-400"},ce={key:1,class:"h-full bg-gray-100 grow month-div"},de={class:"bg-gray-100 rounded select-none text-black h-full"},me=le((()=>(0,n.Lk)("td",{class:"tdl"},null,-1))),ve={class:"my-ceil text-center font-normal"},pe={key:2,class:"bg-gray-100 rounded select-none p-0"},ge=["colspan"],ye={class:"min-w-full min-h-[42px] bg-black"},he={class:"my-ceil text-center font-normal p-0"},fe={class:"flex justify-center align-middle pb-1.5"},be={class:"w-8 h-8 content-center text-normal rounded-full bg-gray-200"};var we=(0,n.pM)({__name:"CapacityHeaders",setup(e){const a=(0,n.EW)((()=>V.getters["capacityData/getScale"])),t=(0,n.EW)((()=>V.getters["capacityData/getYear"])),l=(0,n.EW)((()=>V.getters["capacityData/getMonth"])),s=(0,n.EW)((()=>V.getters["capacityData/getColumnCount"]));return(e,u)=>((0,n.uX)(),(0,n.CE)("div",ne,[(0,n.Lk)("div",se,[(0,n.bF)(te)]),"day"===a.value?((0,n.uX)(),(0,n.CE)("table",ue,[(0,n.Lk)("tr",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(s.value,(e=>((0,n.uX)(),(0,n.CE)("td",oe,[(0,n.Lk)("div",re,[(0,n.Lk)("div",{class:(0,v.C4)([(0,p.R1)(U)(t.value,l.value,e)?["bg-gray-300"]:["bg-gray-200"],"w-8 h-8 content-center text-normal rounded-full"])},[(0,n.Lk)("span",null,(0,v.v_)((0,p.R1)(K)(e)),1)],2)]),(0,n.Lk)("div",ie,(0,v.v_)((0,p.R1)(W)(t.value,l.value,e)),1)])))),256))])])):"month"===a.value?((0,n.uX)(),(0,n.CE)("div",ce,[(0,n.Lk)("table",de,[(0,n.Lk)("tr",null,[me,((0,n.uX)(),(0,n.CE)(n.FK,null,(0,n.pI)(12,(e=>(0,n.Lk)("td",ve,(0,v.v_)((0,p.R1)(I)[e-1]),1))),64))])])])):"week"===a.value?((0,n.uX)(),(0,n.CE)("table",pe,[(0,n.Lk)("tr",null,[(0,n.Lk)("td",{colspan:s.value,class:"p-0 m-0"},[(0,n.Lk)("table",ye,[(0,n.Lk)("tr",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)((0,p.R1)(M),(e=>((0,n.uX)(),(0,n.CE)("td",{style:(0,v.Tr)({width:`${e.percent}%`}),class:"odd:bg-gray-200 even:bg-gray-300 font-normal text-center text-xl"},(0,v.v_)(e.month),5)))),256))])])],8,ge)]),(0,n.Lk)("tr",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(s.value,(e=>((0,n.uX)(),(0,n.CE)("td",he,[(0,n.Lk)("div",fe,[(0,n.Lk)("div",be,(0,v.v_)((0,p.R1)(K)(e)),1)])])))),256))])])):(0,n.Q3)("",!0)]))}});const ke=(0,u.A)(we,[["__scopeId","data-v-719f1398"]]);var _e=ke,xe=t(5116);function Le(e){return Math.round(e/60)}var Ce=Le;const De={class:"text-surface-200"},Ae=(0,n.Lk)("th",null,null,-1),Re={key:0};var Ee=(0,n.pM)({__name:"PopoverData",props:{toggleDetail:{},toggleTypeParam:{}},setup(e){const a=e,t={head1:"План",head2:"Факт",line1:"Деньги",line2:"Время"},l={head1:"Работа",head2:"Овертаймы",line1:"Деньги",line2:"Время"},s=(0,n.EW)((()=>"mainData"===a.toggleTypeParam?t:"detailData"===a.toggleTypeParam?l:(console.error("wrong type of toggle"),t)));return(e,t)=>((0,n.uX)(),(0,n.CE)("table",De,[(0,n.Lk)("tr",null,[Ae,(0,n.Lk)("th",null,(0,v.v_)(s.value.head1),1),(0,n.Lk)("th",null,(0,v.v_)(s.value.head2),1)]),(0,p.R1)(V).getters["meData/getMe"].show_money?((0,n.uX)(),(0,n.CE)("tr",Re,[(0,n.Lk)("td",null,(0,v.v_)(s.value.line1),1),(0,n.Lk)("td",null,(0,v.v_)(Math.round(a.toggleDetail.moneyPlan))+"₽",1),(0,n.Lk)("td",null,(0,v.v_)(a.toggleDetail.moneyFact)+"₽",1)])):(0,n.Q3)("",!0),(0,n.Lk)("tr",null,[(0,n.Lk)("td",null,(0,v.v_)(s.value.line2),1),(0,n.Lk)("td",null,(0,v.v_)((0,p.R1)(Ce)(a.toggleDetail.timePlanMin))+"ч.",1),(0,n.Lk)("td",null,(0,v.v_)((0,p.R1)(Ce)(a.toggleDetail.timeFactMin))+"ч.",1)])]))}});const Fe=Ee;var Ve=Fe;t(3375),t(9225),t(3972),t(9209),t(5714),t(7561),t(6197);function Me(e,a,t){return{r:Math.round(e.r+(a.r-e.r)*t),g:Math.round(e.g+(a.g-e.g)*t),b:Math.round(e.b+(a.b-e.b)*t)}}function Ie(e){function a(e){const a=e.toString(16);return 1==a.length?"0"+a:a}return`#${a(e.r)}${a(e.g)}${a(e.b)}`}function We(e,a,t,l){if(e<=-100)return Ie(a);if(e>=100)return Ie(l);if(e<0){let l=(e+100)/100;return Ie(Me(a,t,l))}{let a=e/100;return Ie(Me(t,l,a))}}function Ue(e){const a=e<0,t=Math.abs(e).toString();let l="";for(let n=t.length-1;n>=0;n-=3){const e=n!==t.length-1?" ":"",a=Math.max(n-2,0),s=t.slice(a,n+1);l=s+e+l}return a?"-"+l:l}const Ke={key:0,class:"text-base"},Xe={key:1,class:"text-base"},Se={key:1,class:"my-ceil border"};var Te=(0,n.pM)({__name:"CapacityCeil",props:{ceilData:{},ceilNumber:{},detailedCeils:{}},emits:["toggle-ceil","toggle-detail"],setup(e,{emit:a}){const t=e,l=a,s=(0,n.EW)((()=>V.getters["capacityRepresentation/getPercentsDigits"])),u=(0,n.EW)((()=>V.getters["capacityRepresentation/getTimeMoney"])),o=(0,n.EW)((()=>s.value?"%":u.value?" h":" ₽")),r=(0,n.EW)((()=>t.ceilData?s.value?u.value?t.ceilData.deltaPercent:t.ceilData.deltaPercentMoney:u.value?Ce(t.ceilData.timePlanMin-t.ceilData.timeFactMin):t.ceilData.moneyPlan-t.ceilData.moneyFact:0)),i=(0,n.EW)((()=>{let e;return e=u.value?t.ceilData.deltaPercent:t.ceilData.deltaPercentMoney,We(e,{r:138,g:181,b:230},{r:255,g:255,b:255},{r:230,g:115,b:131})})),c=(0,n.EW)((()=>t.detailedCeils.has(t.ceilNumber)));return(e,a)=>t.ceilData?((0,n.uX)(),(0,n.CE)("td",{key:0,class:(0,v.C4)(["my-ceil text-center bg-white text-base p-2 border select-none",c.value?["shadow-[inset_0_5px_10px_-2px_rgba(0,0,0,0.2)]"]:[]]),style:(0,v.Tr)({backgroundColor:i.value}),onMouseenter:a[0]||(a[0]=e=>l("toggle-ceil",{event:e,data:t.ceilData,show:!0,type:"mainData"})),onMouseleave:a[1]||(a[1]=e=>l("toggle-ceil",{event:e,data:void 0,show:!1,type:"mainData"})),onClick:a[2]||(a[2]=a=>l("toggle-detail",e.ceilNumber))},[s.value||u.value?((0,n.uX)(),(0,n.CE)("span",Xe,(0,v.v_)(r.value)+(0,v.v_)(o.value),1)):((0,n.uX)(),(0,n.CE)("span",Ke,(0,v.v_)((0,p.R1)(Ue)(r.value))+(0,v.v_)(o.value),1))],38)):((0,n.uX)(),(0,n.CE)("td",Se))}});const Ne=(0,u.A)(Te,[["__scopeId","data-v-01b8b59c"]]);var je=Ne;const Pe={id:-1,userId:-1,userName:"",userActive:!1,taskId:-1,taskName:"",projectName:"",planTimeMinutes:0,overtimeMinutes:0,planSalary:0,overtimeSalary:0,totalTimeMinutes:0,totalSalary:0,year:2024},Be=["planTimeMinutes","overtimeMinutes","planSalary","overtimeSalary","totalTimeMinutes","totalSalary"],Oe={planTimeMinutes:0,overtimeMinutes:0,planSalary:0,overtimeSalary:0,totalTimeMinutes:0,totalSalary:0};function Ye(e,a,t,l){let n=[];return e.forEach((e=>{let s=[];for(let n=1;n<=t;n++){const t=a.filter((a=>a[l]===n&&a.taskId===e));s.push(t.length>0?t[0]:Pe)}n.push({taskId:e,taskName:a.find((a=>a.taskId===e))?.taskName,records:s})})),n}function ze(e){return new Set(e.map((e=>e.projectName)))}function $e(e,a){let t=[];for(let l=1;l<=a;l++){let a=e.reduce(((e,a)=>{const t=a.records[l-1];return Be.forEach((a=>{e[a]+=t[a]})),e}),{...Oe});t.push(a)}return t}function Qe(e,a,t){let l=[];const n=ze(e);return n.forEach((n=>{const s=new Set(e.filter((e=>e.projectName===n)).map((e=>e.taskId)));let u=Ye(s,e,t,a);l.push({projectName:n,tasks:u,records:$e(u,t)})})),l}async function Ge(e,a,t,l,n){if(0===t.size)return[];const s=[...t].join(",");return"day"===e?(await w.A.get(k+"/detail_data/day/"+a+"/"+l+"/"+n+"/?days="+s)).data:"week"===e?(await w.A.get(k+"/detail_data/week/"+a+"/"+l+"/?weeks="+s)).data:"month"===e?(await w.A.get(k+"/detail_data/month/"+a+"/"+l+"/?months="+s)).data:(console.error("wrong scale value"),[])}const He={key:0},Je={key:1};var qe=(0,n.pM)({__name:"CapacityDetailCeil",props:{data:{},classes:{}},setup(e){const a=e,t=(0,n.EW)((()=>V.getters["capacityRepresentation/getTimeMoney"])),l=(0,n.EW)((()=>t.value?Math.round(a.data.totalTimeMinutes/60*10)/10:a.data.totalSalary)),s=(0,n.EW)((()=>t.value?" h":" ₽"));return(e,a)=>0!==e.data.totalTimeMinutes?((0,n.uX)(),(0,n.CE)("td",{key:0,class:(0,v.C4)(["text-center p-2 border select-none text-black",e.classes])},[t.value?((0,n.uX)(),(0,n.CE)("span",He,(0,v.v_)(l.value)+(0,v.v_)(s.value),1)):((0,n.uX)(),(0,n.CE)("span",Je,(0,v.v_)((0,p.R1)(Ue)(l.value))+(0,v.v_)(s.value),1))],2)):((0,n.uX)(),(0,n.CE)("td",{key:1,class:(0,v.C4)(["text-center text-sm p-2 border select-none",e.classes])},null,2))}});const Ze=qe;var ea=Ze;const aa=(0,n.Lk)("td",{class:"bg-white min-w-4 sticky left-0"},null,-1),ta={class:"sticky left-3 bg-gray-300 name_ceil p-0"},la={class:"flex flex-col h-full"},na=(0,n.Lk)("div",{class:"min-w-full min-h-px max-h-px overflow-visible"},[(0,n.Lk)("div",{class:"min-w-full min-h-px max-h-px bg-gray-200 my-[-0.5px]"})],-1),sa={class:"grow basis-full text-ellipsis overflow-hidden text-base text-black p-2"},ua={class:"select-none"},oa=(0,n.Lk)("td",{class:"bg-white min-w-4 sticky left-0"},null,-1),ra={class:"sticky left-3 name_ceil text-ellipsis overflow-hidden bg-gray-100 text-black p-0"},ia={class:"flex flex-col h-full"},ca=(0,n.Lk)("div",{class:"min-w-full min-h-px max-h-px overflow-visible"},[(0,n.Lk)("div",{class:"min-w-full min-h-px max-h-px bg-gray-200 my-[-0.5px]"})],-1),da={class:"grow basis-full text-ellipsis overflow-hidden text-base text-black p-2"},ma=(0,n.Lk)("div",{class:"min-w-full min-h-px max-h-px overflow-visible"},[(0,n.Lk)("div",{class:"min-w-full min-h-px max-h-px bg-gray-200 my-[-0.5px]"})],-1);var va=(0,n.pM)({__name:"CapacityDetailLine",props:{data:{}},setup(e){const a=(0,p.KR)(!1);function t(){a.value=!a.value}return(e,s)=>((0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.Lk)("tr",{onClick:s[0]||(s[0]=e=>t()),class:"cursor-pointer select-none h-full"},[aa,(0,n.Lk)("td",ta,[(0,n.Lk)("div",la,[na,(0,n.Lk)("div",sa,(0,v.v_)(e.data.projectName),1)])]),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.data.records,(e=>((0,n.uX)(),(0,n.Wv)(ea,{data:e,classes:["bg-gray-300"]},null,8,["data"])))),256))]),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.data.tasks,(e=>(0,n.bo)(((0,n.uX)(),(0,n.CE)("tr",ua,[oa,(0,n.Lk)("td",ra,[(0,n.Lk)("div",ia,[ca,(0,n.Lk)("div",da,(0,v.v_)(e.taskName),1)]),ma]),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.records,(e=>((0,n.uX)(),(0,n.Wv)(ea,{data:e,classes:["bg-white","border-gray-200"]},null,8,["data"])))),256))],512)),[[l.aG,a.value]]))),256))],64))}});const pa=va;var ga=pa,ya=(0,n.pM)({__name:"CapacityDetailModule",props:{selectedNumbers:{},userId:{}},setup(e){const a=e,t=(0,n.EW)((()=>V.getters["capacityData/getScale"])),l=(0,n.EW)((()=>V.getters["capacityData/getYear"])),s=(0,n.EW)((()=>V.getters["capacityData/getMonth"])),u=(0,n.EW)((()=>V.getters["capacityData/getColumnCount"])),o=(0,n.EW)((()=>new Set(a.selectedNumbers.values()))),r=(0,n.EW)((()=>a.userId)),i=(0,p.KR)([]),c=(0,p.KR)(!1);return(0,n.nT)((async()=>{c.value=!0;try{const e=await Ge(t.value,r.value,o.value,l.value,s.value);i.value=Qe(e,t.value,u.value)}catch(e){console.error("Ошибка при загрузке данных:",e),i.value=[]}finally{c.value=!1}})),(e,a)=>((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(i.value,(e=>((0,n.uX)(),(0,n.Wv)(ga,{data:e},null,8,["data"])))),256))}});const ha=ya;var fa=ha;const ba={key:0,class:"mr-2 flex items-center justify-center"},wa=(0,n.Lk)("svg",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",viewBox:"0 0 512 512",class:"text-red-500",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg"},[(0,n.Lk)("path",{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"})],-1),ka=[wa];var _a=(0,n.pM)({__name:"InactiveUserIcon",props:{userActive:{type:Boolean}},setup(e){const a=e;return(e,t)=>a.userActive?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",ba,ka))}});const xa=_a;var La=xa;const Ca={class:"cursor-pointer text-black"},Da={class:"bg-white min-w-4 sticky left-0"},Aa={class:"flex flex-nowrap"},Ra={class:"grow align-middle"};var Ea=(0,n.pM)({__name:"CapacityLine",props:{userData:{},showDetails:{type:Boolean}},emits:["toggle-ceil","toggle-detail"],setup(e,{emit:a}){const t=e,l=a,s=(0,n.EW)((()=>V.getters["capacityData/getColumnCount"])),u=(0,p.KR)(new Set),o=(0,n.EW)((()=>{t.showDetails||(u.value=new Set)}));function r(e){l("toggle-detail",null),u.value.has(e)?u.value.delete(e):u.value.add(e)}function i(){l("toggle-detail",null),u.value.size!==s.value?u.value=new Set(Array(s.value).fill(0).map(((e,a)=>a+1))):u.value=new Set}return(e,a)=>((0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.Lk)("tr",Ca,[(0,n.Lk)("td",Da,(0,v.v_)(o.value),1),(0,n.Lk)("td",{class:"sticky left-3 bg-gray-200 text-base p-2 name_ceil select-none shadow-md w-40",onClick:a[0]||(a[0]=e=>i())},[(0,n.Lk)("div",Aa,[(0,n.Lk)("div",Ra,(0,v.v_)(e.userData.userName),1),(0,n.bF)(La,{"user-active":e.userData.userActive},null,8,["user-active"])])]),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.userData.data,((e,t)=>((0,n.uX)(),(0,n.Wv)(je,{"ceil-data":e,onToggleCeil:a[1]||(a[1]=e=>l("toggle-ceil",e)),onToggleDetail:a[2]||(a[2]=e=>r(e)),"ceil-number":t+1,"detailed-ceils":u.value},null,8,["ceil-data","ceil-number","detailed-ceils"])))),256))]),0!==u.value.size&&t.showDetails?((0,n.uX)(),(0,n.Wv)(fa,{key:0,"selected-numbers":u.value,"user-id":e.userData.userId},null,8,["selected-numbers","user-id"])):(0,n.Q3)("",!0)],64))}});const Fa=Ea;var Va=Fa;const Ma={class:"h-full"};var Ia=(0,n.pM)({__name:"CapacityTeamData",props:{teamId:{},showDetails:{type:Boolean}},emits:["toggle-ceil","toggle-detail"],setup(e,{emit:a}){const t=e,l=a,s=(0,n.EW)((()=>V.getters["capacityData/getByUserData"].filter((e=>e.teamId===t.teamId)).sort(((e,a)=>e.userName===a.userName))));return(e,a)=>((0,n.uX)(),(0,n.CE)("table",Ma,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(s.value,(e=>((0,n.uX)(),(0,n.Wv)(Va,{key:e.userId,"user-data":e,onToggleCeil:a[0]||(a[0]=e=>l("toggle-ceil",e)),onToggleDetail:a[1]||(a[1]=e=>l("toggle-detail",null)),"show-details":t.showDetails},null,8,["user-data","show-details"])))),128))]))}});const Wa=Ia;var Ua=Wa;const Ka={class:"h-fit min-w-fit max-w-fit text-nowrap mx-4 my-2 shadow-lg bg-white rounded-lg py-4 pr-4 pl-1"},Xa={class:"sticky left-3 pb-2 font-bold text-xl text-left w-40 bg-white text-black ml-4"};var Sa=(0,n.pM)({__name:"CapacityTeamsTable",props:{teamInfo:{}},emits:["toggle-ceil"],setup(e,{emit:a}){const t=a,l=e,s=(0,p.KR)(!1);function u(){s.value=!1}function o(){s.value=!0}return(e,a)=>((0,n.uX)(),(0,n.CE)("div",null,[(0,n.Lk)("div",Ka,[(0,n.Lk)("div",Xa,[(0,n.Lk)("span",{class:(0,v.C4)(["text-2xl select-none",s.value?["cursor-pointer"]:[]]),onClick:a[0]||(a[0]=e=>u())},(0,v.v_)(l.teamInfo.teamName),3)]),(0,n.Lk)("div",null,[(0,n.bF)(Ua,{"team-id":l.teamInfo.teamId,onToggleCeil:a[1]||(a[1]=e=>t("toggle-ceil",e)),onToggleDetail:a[2]||(a[2]=e=>o()),"show-details":s.value},null,8,["team-id","show-details"])])])]))}});const Ta=Sa;var Na=Ta,ja=(0,n.pM)({__name:"CapacityTable",setup(e){const a=(0,p.KR)(!1);(0,n.KC)((async()=>{await V.dispatch("capacityData/loadData"),a.value=!0}));const t=(0,n.EW)((()=>a.value?V.getters["capacityData/getTeamList"]:[])),l=(0,n.EW)((()=>V.getters["capacityData/getScale"])),s=(0,p.KR)(),u=(0,p.KR)(),o=(0,p.KR)(),r=e=>{e.data?(u.value=e.data,o.value=e.type,e.show?s.value.toggle(e.event):s.value.hide()):s.value.hide()};return(e,a)=>((0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.Lk)("div",{class:(0,v.C4)(["flex overflow-auto flex-col scroll-div bg-gray-100 capacity-variables","month"===l.value?["items-center"]:[]])},[(0,n.bF)(_e),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(t.value,(e=>((0,n.uX)(),(0,n.Wv)(Na,{"team-info":e,onToggleCeil:a[0]||(a[0]=e=>r(e))},null,8,["team-info"])))),256))],2),(0,n.bF)((0,p.R1)(xe.A),{ref_key:"op",ref:s,style:{"--p-popover-background":"#1e282d"}},{default:(0,n.k6)((()=>[(0,n.bF)(Ve,{"toggle-detail":u.value,"toggle-type-param":o.value},null,8,["toggle-detail","toggle-type-param"])])),_:1},512)],64))}});const Pa=(0,u.A)(ja,[["__scopeId","data-v-20323c96"]]);var Ba=Pa,Oa=(0,n.pM)({components:{CapacityNavigation:te,CapacityTable:Ba}});const Ya=(0,u.A)(Oa,[["render",m]]);var za=Ya,$a=t(6338),Qa=t(2046),Ga=t(6735),Ha=(0,n.pM)({__name:"TeamSelector",emits:["change"],setup(e,{emit:a}){const t=a,l=(0,n.EW)((()=>V.getters["userData/getTeamList"])),s=(0,p.KR)(null);return(e,a)=>((0,n.uX)(),(0,n.Wv)((0,p.R1)(Ga.A),{modelValue:s.value,"onUpdate:modelValue":a[0]||(a[0]=e=>s.value=e),options:l.value,optionLabel:"name",optionValue:"id",placeholder:"Выберите команду",class:"w-full md:w-56",onChange:a[1]||(a[1]=e=>t("change",l.value.filter((e=>e.id===s.value))[0]))},null,8,["modelValue","options"]))}});const Ja=Ha;var qa=Ja,Za=(0,n.pM)({__name:"AsanaUserSelector",emits:["change"],setup(e,{emit:a}){const t=a,l=(0,n.EW)((()=>V.getters["userData/getEmptyAsanaUsersList"])),s=(0,p.KR)(null);return(e,a)=>((0,n.uX)(),(0,n.Wv)((0,p.R1)(Ga.A),{modelValue:s.value,"onUpdate:modelValue":a[0]||(a[0]=e=>s.value=e),options:l.value,optionLabel:"name",optionValue:"gid",placeholder:"Выберите пользователя Asana",class:"w-full w-[300px]",filter:"",showClear:"",onChange:a[1]||(a[1]=e=>t("change",null===s.value?null:l.value.filter((e=>e.gid===s.value))[0]))},null,8,["modelValue","options"]))}});const et=Za;var at=et,tt=t(6064);function lt(e){return null===e.firstName?(alert("first_name is empty"),!1):e.firstName.length<2?(alert("first_name is short"),!1):e.firstName.length>256?(alert("first_name is big"),!1):null===e.lastName?(alert("last_name is empty"),!1):e.lastName.length<2?(alert("last_name is short"),!1):e.lastName.length>256?(alert("last_name is big"),!1):null!==e.fatherName&&e.fatherName.length>256?(alert("father_name is big"),!1):null!==e.phone&&e.phone.length>256?(alert("phone is big"),!1):null!==e.email&&e.email.length>1024?(alert("email is big"),!1):null===e.login?(alert("login is empty"),!1):e.login.length<2?(alert("login is short"),!1):e.login.length>128?(alert("login is big"),!1):null===e.password?(alert("password is empty"),!1):e.password.length<2?(alert("password is short"),!1):e.password.length>128?(alert("password is big"),!1):0===e.salary?(alert("salary is 0"),!1):0!=e.teamId&&null!=e.teamId||(alert("need select team"),!1)}const nt={class:"w-fit"},st={class:"flex nowrap mt-5"},ut={class:"w-[300px]"},ot={class:"flex nowrap mt-5"},rt={class:"mx-5"},it=(0,n.Lk)("br",null,null,-1),ct={class:"mx-5"},dt=(0,n.Lk)("br",null,null,-1),mt={class:"mx-5"},vt=(0,n.Lk)("br",null,null,-1),pt={class:"flex nowrap mt-5"},gt={class:"mx-5"},yt=(0,n.Lk)("br",null,null,-1),ht={class:"mx-5"},ft=(0,n.Lk)("br",null,null,-1),bt={class:"flex nowrap mt-5"},wt={class:"mx-5"},kt=(0,n.Lk)("br",null,null,-1),_t={class:"mx-5"},xt=(0,n.Lk)("br",null,null,-1),Lt={class:"flex nowrap mt-5"},Ct={class:"mx-5"},Dt=(0,n.Lk)("br",null,null,-1),At={class:"flex flex-wrap gap-4 mx-5"},Rt={class:"flex items-center"},Et=(0,n.Lk)("label",{for:"salary_month",class:"ml-2"},"Месяц",-1),Ft={class:"flex items-center"},Vt=(0,n.Lk)("label",{for:"salary_hour",class:"ml-2"},"Час",-1),Mt={class:"flex mt-5 justify-center"};var It=(0,n.pM)({__name:"CreateUserForm",setup(e){const a=(0,p.KR)(""),t=(0,p.KR)(""),l=(0,p.KR)(""),s=(0,p.KR)(""),u=(0,p.KR)(""),o=(0,p.KR)(""),r=(0,p.KR)(""),i=(0,p.KR)(0),c=(0,p.KR)(1),d=(0,p.KR)(null),m=(0,p.KR)(0);function v(e){null!==e?(s.value=e.email,d.value=e.gid):(d.value=null,s.value=null)}function g(e){m.value=e.id}function y(){a.value="",t.value="",l.value="",s.value="",u.value="",o.value="",r.value="",i.value=0,c.value=1,d.value=null,m.value=0}async function h(){if(!lt({firstName:a.value,lastName:t.value,fatherName:l.value,email:s.value,phone:u.value,login:o.value,password:r.value,salary:i.value,salaryType:c.value,asanaGid:d.value,teamId:m.value}))return;const e=await w.A.post(k+"/user/",{email:s.value,phone:u.value,login:o.value,password:r.value,first_name:a.value,last_name:t.value,father_name:l.value,asana_gid:d.value,team_id:m.value,salary:i.value,salary_type:c.value},_);200===e.status?y():alert(e.statusText)}return(e,d)=>((0,n.uX)(),(0,n.CE)("div",nt,[(0,n.Lk)("div",st,[(0,n.bF)(qa,{class:"mx-5",onChange:d[0]||(d[0]=e=>g(e))}),(0,n.Lk)("div",ut,[(0,n.bF)(at,{onChange:d[1]||(d[1]=e=>v(e))})])]),(0,n.Lk)("div",ot,[(0,n.Lk)("div",rt,[(0,n.eW)(" Имя "),it,(0,n.bF)((0,p.R1)($a.A),{id:"first_name",modelValue:a.value,"onUpdate:modelValue":d[2]||(d[2]=e=>a.value=e)},null,8,["modelValue"])]),(0,n.Lk)("div",ct,[(0,n.eW)(" Фамилия "),dt,(0,n.bF)((0,p.R1)($a.A),{id:"last_name",modelValue:t.value,"onUpdate:modelValue":d[3]||(d[3]=e=>t.value=e)},null,8,["modelValue"])]),(0,n.Lk)("div",mt,[(0,n.eW)(" Отчество "),vt,(0,n.bF)((0,p.R1)($a.A),{id:"father_name",modelValue:l.value,"onUpdate:modelValue":d[4]||(d[4]=e=>l.value=e)},null,8,["modelValue"])])]),(0,n.Lk)("div",pt,[(0,n.Lk)("div",gt,[(0,n.eW)(" Почта "),yt,(0,n.bF)((0,p.R1)($a.A),{id:"email",modelValue:s.value,"onUpdate:modelValue":d[5]||(d[5]=e=>s.value=e)},null,8,["modelValue"])]),(0,n.Lk)("div",ht,[(0,n.eW)(" Телефон "),ft,(0,n.bF)((0,p.R1)($a.A),{id:"phone",modelValue:u.value,"onUpdate:modelValue":d[6]||(d[6]=e=>u.value=e)},null,8,["modelValue"])])]),(0,n.Lk)("div",bt,[(0,n.Lk)("div",wt,[(0,n.eW)(" Логин"),kt,(0,n.bF)((0,p.R1)($a.A),{id:"login",modelValue:o.value,"onUpdate:modelValue":d[7]||(d[7]=e=>o.value=e)},null,8,["modelValue"])]),(0,n.Lk)("div",_t,[(0,n.eW)(" Пароль"),xt,(0,n.bF)((0,p.R1)($a.A),{id:"password",modelValue:r.value,"onUpdate:modelValue":d[8]||(d[8]=e=>r.value=e)},null,8,["modelValue"])])]),(0,n.Lk)("div",Lt,[(0,n.Lk)("div",Ct,[(0,n.eW)(" Оклад"),Dt,(0,n.bF)((0,p.R1)(tt.A),{modelValue:i.value,"onUpdate:modelValue":d[9]||(d[9]=e=>i.value=e),fluid:""},null,8,["modelValue"])]),(0,n.Lk)("div",At,[(0,n.Lk)("div",Rt,[(0,n.bF)((0,p.R1)(Qa.A),{modelValue:c.value,"onUpdate:modelValue":d[10]||(d[10]=e=>c.value=e),name:"Месяц",value:1,inputId:"salary_month"},null,8,["modelValue"]),Et]),(0,n.Lk)("div",Ft,[(0,n.bF)((0,p.R1)(Qa.A),{modelValue:c.value,"onUpdate:modelValue":d[11]||(d[11]=e=>c.value=e),name:"Час",value:2,inputId:"salary_hour"},null,8,["modelValue"]),Vt])])]),(0,n.Lk)("div",Mt,[(0,n.bF)((0,p.R1)(P.A),{label:"Создать",onClick:d[12]||(d[12]=e=>h())})])]))}});const Wt=It;var Ut=Wt,Kt=t(1807),Xt=t(9778),St=t(514),Tt=t(3441),Nt=t(8364),jt=t(5976);function Pt({first_name:e,last_name:a,father_name:t}){return`${a} ${e.charAt(0).toUpperCase()+"."}${t?t.charAt(0).toUpperCase()+".":""}`}var Bt=(0,n.pM)({__name:"AsanaUserSelector",props:{disabled:{type:Boolean},issetAsanaUser:{}},emits:["change"],setup(e,{emit:a}){const t=e,l=a,s=(0,n.EW)((()=>t.issetAsanaUser?[...V.getters["userData/getEmptyAsanaUsersList"],t.issetAsanaUser]:V.getters["userData/getEmptyAsanaUsersList"])),u=(0,p.KR)(t.issetAsanaUser?t.issetAsanaUser.gid:null);return(0,n.wB)((()=>t.issetAsanaUser),(e=>{u.value=e?e.gid:null})),(e,a)=>((0,n.uX)(),(0,n.Wv)((0,p.R1)(Ga.A),{modelValue:u.value,"onUpdate:modelValue":a[0]||(a[0]=e=>u.value=e),options:s.value,optionLabel:"name",optionValue:"gid",placeholder:"",class:"w-full w-[300px]",filter:"",showClear:"",onChange:a[1]||(a[1]=e=>l("change",null===u.value?null:s.value.filter((e=>e.gid===u.value))[0])),disabled:t.disabled},null,8,["modelValue","options","disabled"]))}});const Ot=Bt;var Yt=Ot,zt=t(9848),$t=(0,n.pM)({__name:"TeamSelector",props:{issetTeamId:{},disabled:{type:Boolean}},emits:["change"],setup(e,{emit:a}){const t=e,l=a,s=(0,n.EW)((()=>V.getters["userData/getTeamList"])),u=(0,p.KR)(t.issetTeamId);return(0,n.wB)((()=>t.issetTeamId),(e=>{u.value=e})),(e,a)=>((0,n.uX)(),(0,n.Wv)((0,p.R1)(Ga.A),{modelValue:u.value,"onUpdate:modelValue":a[0]||(a[0]=e=>u.value=e),options:s.value,optionLabel:"name",optionValue:"id",placeholder:"",class:"w-full md:w-56",onChange:a[1]||(a[1]=e=>l("change",s.value.filter((e=>e.id===u.value))[0])),disabled:e.disabled},null,8,["modelValue","options","disabled"]))}});const Qt=$t;var Gt=Qt,Ht=t(5215),Jt=t(373),qt=(0,n.pM)({__name:"CommentField",props:{workId:{},workComment:{}},emits:["change"],setup(e,{emit:a}){const t=e,l=a;(0,n.wB)((()=>t.workComment),(e=>{s.value=e}));const s=(0,p.KR)(t.workComment);return(e,a)=>((0,n.uX)(),(0,n.Wv)((0,p.R1)($a.A),{type:"text",modelValue:s.value,"onUpdate:modelValue":a[0]||(a[0]=e=>s.value=e),onChange:a[1]||(a[1]=e=>l("change",{id:t.workId,text:s.value}))},null,8,["modelValue"]))}});const Zt=qt;var el=Zt,al=(0,n.pM)({__name:"DateField",props:{workId:{},date:{}},emits:["change"],setup(e,{emit:a}){const t=e,s=a;(0,n.wB)((()=>t.date),(async e=>{u.value=e}));const u=(0,p.KR)(t.date);return(e,a)=>(0,n.bo)(((0,n.uX)(),(0,n.CE)("input",{type:"date","onUpdate:modelValue":a[0]||(a[0]=e=>u.value=e),onInput:a[1]||(a[1]=e=>s("change",{id:t.workId,date:e.target.value}))},null,544)),[[l.Jo,u.value]])}});const tl=al;var ll=tl,nl=(0,n.pM)({__name:"WorkChangesData",props:{user_id:{}},setup(e){const a=e;(0,n.KC)((async()=>{a.user_id&&(l.value=(await w.A.get(k+"/work_changes/"+a.user_id+"/")).data,t.value=!0)})),(0,n.wB)((()=>a.user_id),(async e=>{a.user_id?(l.value=[],l.value=(await w.A.get(k+"/work_changes/"+a.user_id+"/")).data,t.value=!0):(l.value=[],t.value=!1)}));const t=(0,p.KR)(!1),l=(0,p.KR)([]),s={headers:{"Content-Type":"application/json"},withCredentials:!0};async function u({id:e,text:a}){await w.A.put(k+"/work_changes/comment/",{id:e,text:a},s)}async function o({id:e,date:a}){await w.A.put(k+"/work_changes/date/",{id:e,date:a},s)}async function r({id:e,typeId:a}){await w.A.put(k+"/work_changes/type/",{id:e,typeId:a},s)}return(e,a)=>{const s=(0,n.g2)("typeSelector");return t.value?((0,n.uX)(),(0,n.Wv)((0,p.R1)(Ht.A),{key:0,value:l.value,tableStyle:"min-width: 50rem"},{default:(0,n.k6)((()=>[(0,n.bF)((0,p.R1)(Jt.A),{field:"date",header:"Дата"},{body:(0,n.k6)((e=>[(0,n.bF)(ll,{workId:e.data.id,date:e.data.date,onChange:a[0]||(a[0]=e=>o(e))},null,8,["workId","date"])])),_:1}),(0,n.bF)((0,p.R1)(Jt.A),{field:"type",header:"Тип"},{body:(0,n.k6)((e=>[(0,n.bF)(s,{workId:e.data.id,typeId:e.data.type,onChange:r},null,8,["workId","typeId"])])),_:1}),(0,n.bF)((0,p.R1)(Jt.A),{field:"comment",header:"Комментарий"},{body:(0,n.k6)((e=>[(0,n.bF)(el,{workId:e.data.id,workComment:e.data.comment,onChange:a[1]||(a[1]=e=>u(e))},null,8,["workId","workComment"])])),_:1})])),_:1},8,["value"])):(0,n.Q3)("",!0)}}});const sl=nl;var ul=sl;const ol={class:"flex bg-amber-500 flex-col"},rl={class:"w-fit bg-fuchsia-400 h-fit mb-2"},il={class:"flex nowrap mt-5"},cl={class:"w-[300px]"},dl={class:"flex nowrap mt-5"},ml={class:"mx-5"},vl=(0,n.Lk)("br",null,null,-1),pl={class:"mx-5"},gl=(0,n.Lk)("br",null,null,-1),yl={class:"mx-5"},hl=(0,n.Lk)("br",null,null,-1),fl={class:"flex nowrap mt-5"},bl={class:"mx-5"},wl=(0,n.Lk)("br",null,null,-1),kl={class:"mx-5"},_l=(0,n.Lk)("br",null,null,-1),xl={class:"flex nowrap mt-5"},Ll={class:"mx-5"},Cl=(0,n.Lk)("br",null,null,-1),Dl={class:"mx-5"},Al=(0,n.Lk)("br",null,null,-1),Rl={class:"flex"},El={class:"flex self-center align-middle"},Fl={class:"flex mt-5 justify-center"},Vl={class:"flex nowrap"},Ml=(0,n.Lk)("div",null,null,-1);var Il=(0,n.pM)({__name:"EditUserForm",setup(e){(0,n.KC)((async()=>{const e=(await w.A.get(k+"/user?fields=id,first_name,last_name,father_name")).data;a.value=e.map((e=>({id:e.id,userName:Pt({first_name:e.first_name,last_name:e.last_name,father_name:e.father_name})}))).sort(((e,a)=>e.userName.localeCompare(a.userName)))}));const a=(0,p.KR)([]),t=(0,p.KR)(null),l=(0,p.KR)(null),s=(0,p.KR)(""),u=(0,p.KR)(""),o=(0,p.KR)(""),r=(0,p.KR)(""),i=(0,p.KR)(""),c=(0,p.KR)(""),d=(0,p.KR)(null),m=(0,p.KR)(0),v=(0,p.KR)(!0),g=(0,p.KR)(null),y=(0,n.EW)((()=>null===l.value));async function h(){t.value?(l.value=(await w.A.get(k+"/user/"+t.value?.id+"/")).data,l.value&&(s.value=l.value.first_name,u.value=l.value.last_name,o.value=l.value.father_name,r.value=l.value.email,i.value=l.value.phone,c.value=l.value.login,m.value=l.value.team_id,d.value=null,v.value=l.value.is_active,g.value=l.value.asana_gid?{gid:l.value.asana_gid,name:l.value.asana_name,email:l.value.email}:null)):f()}function f(){l.value=null,s.value="",u.value="",o.value="",r.value="",i.value="",c.value="",m.value=0,d.value=null,g.value=null}async function b(){if(l.value){await w.A.put(k+"/user/",{id:l.value.id,team_id:m.value,asana_gid:g.value?g.value.gid:null,first_name:s.value,last_name:u.value,father_name:o.value,email:r.value,phone:i.value,login:c.value,password:d.value,is_active:v.value},_);f()}}function x(e){g.value=e}function L(e){m.value=e.id}return(e,f)=>((0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)((0,p.R1)(jt.A),{modelValue:t.value,"onUpdate:modelValue":f[0]||(f[0]=e=>t.value=e),options:a.value,filter:"",optionLabel:"userName",class:"w-[200px]",scrollHeight:"50rem",onChange:f[1]||(f[1]=e=>h())},null,8,["modelValue","options"]),(0,n.Lk)("div",ol,[(0,n.Lk)("div",rl,[(0,n.Lk)("div",il,[(0,n.bF)(Gt,{class:"mx-5",issetTeamId:m.value,disabled:y.value,onChange:f[2]||(f[2]=e=>L(e))},null,8,["issetTeamId","disabled"]),(0,n.Lk)("div",cl,[(0,n.bF)(Yt,{onChange:f[3]||(f[3]=e=>x(e)),disabled:y.value,issetAsanaUser:g.value},null,8,["disabled","issetAsanaUser"])])]),(0,n.Lk)("div",dl,[(0,n.Lk)("div",ml,[(0,n.eW)(" Имя "),vl,(0,n.bF)((0,p.R1)($a.A),{id:"first_name",modelValue:s.value,"onUpdate:modelValue":f[4]||(f[4]=e=>s.value=e),disabled:y.value},null,8,["modelValue","disabled"])]),(0,n.Lk)("div",pl,[(0,n.eW)(" Фамилия "),gl,(0,n.bF)((0,p.R1)($a.A),{id:"last_name",modelValue:u.value,"onUpdate:modelValue":f[5]||(f[5]=e=>u.value=e),disabled:y.value},null,8,["modelValue","disabled"])]),(0,n.Lk)("div",yl,[(0,n.eW)(" Отчество "),hl,(0,n.bF)((0,p.R1)($a.A),{id:"father_name",modelValue:o.value,"onUpdate:modelValue":f[6]||(f[6]=e=>o.value=e),disabled:y.value},null,8,["modelValue","disabled"])])]),(0,n.Lk)("div",fl,[(0,n.Lk)("div",bl,[(0,n.eW)(" Почта "),wl,(0,n.bF)((0,p.R1)($a.A),{id:"email",modelValue:r.value,"onUpdate:modelValue":f[7]||(f[7]=e=>r.value=e),disabled:y.value},null,8,["modelValue","disabled"])]),(0,n.Lk)("div",kl,[(0,n.eW)(" Телефон "),_l,(0,n.bF)((0,p.R1)($a.A),{id:"phone",modelValue:i.value,"onUpdate:modelValue":f[8]||(f[8]=e=>i.value=e),disabled:y.value},null,8,["modelValue","disabled"])])]),(0,n.Lk)("div",xl,[(0,n.Lk)("div",Ll,[(0,n.eW)(" Логин"),Cl,(0,n.bF)((0,p.R1)($a.A),{id:"login",modelValue:c.value,"onUpdate:modelValue":f[9]||(f[9]=e=>c.value=e),disabled:y.value},null,8,["modelValue","disabled"])]),(0,n.Lk)("div",Dl,[(0,n.eW)(" Пароль"),Al,(0,n.bF)((0,p.R1)($a.A),{id:"login",modelValue:d.value,"onUpdate:modelValue":f[10]||(f[10]=e=>d.value=e),disabled:y.value},null,8,["modelValue","disabled"])]),(0,n.Lk)("div",Rl,[(0,n.Lk)("div",El,[(0,n.eW)(" Активен "),(0,n.bF)((0,p.R1)(zt.A),{modelValue:v.value,"onUpdate:modelValue":f[11]||(f[11]=e=>v.value=e),disabled:y.value,class:"ml-2"},null,8,["modelValue","disabled"])])])]),(0,n.Lk)("div",Fl,[(0,n.bF)((0,p.R1)(P.A),{label:"Изменить",onClick:f[12]||(f[12]=e=>b())})])]),(0,n.Lk)("div",Vl,[(0,n.Lk)("div",null,[(0,n.bF)(ul,{user_id:l.value?.id},null,8,["user_id"])]),Ml])])],64))}});const Wl=Il;var Ul=Wl;const Kl={class:"flex justify-center"},Xl={class:"flex justify-center"},Sl=(0,n.Lk)("div",{class:"flex justify-center"},null,-1);var Tl=(0,n.pM)({__name:"UsersView",setup(e){return(0,n.KC)((async()=>{await V.dispatch("userData/loadTeamList"),await V.dispatch("userData/loadEmptyAsanaUsersList")})),(e,a)=>((0,n.uX)(),(0,n.Wv)((0,p.R1)(Kt.A),{value:"0"},{default:(0,n.k6)((()=>[(0,n.bF)((0,p.R1)(Xt.A),null,{default:(0,n.k6)((()=>[(0,n.bF)((0,p.R1)(St.A),{value:"0"},{default:(0,n.k6)((()=>[(0,n.eW)("Регистрация")])),_:1}),(0,n.bF)((0,p.R1)(St.A),{value:"1"},{default:(0,n.k6)((()=>[(0,n.eW)("Редактирование")])),_:1}),(0,n.bF)((0,p.R1)(St.A),{value:"2"},{default:(0,n.k6)((()=>[(0,n.eW)("Производственный календарь")])),_:1})])),_:1}),(0,n.bF)((0,p.R1)(Tt.A),null,{default:(0,n.k6)((()=>[(0,n.bF)((0,p.R1)(Nt.A),{value:"0"},{default:(0,n.k6)((()=>[(0,n.Lk)("div",Kl,[(0,n.bF)(Ut)])])),_:1}),(0,n.bF)((0,p.R1)(Nt.A),{value:"1"},{default:(0,n.k6)((()=>[(0,n.Lk)("div",Xl,[(0,n.bF)(Ul)])])),_:1}),(0,n.bF)((0,p.R1)(Nt.A),{value:"2"},{default:(0,n.k6)((()=>[Sl])),_:1})])),_:1})])),_:1}))}});const Nl=Tl;var jl=Nl,Pl=t(1839),Bl=t(4127);const Ol={class:"bg-gray-100 min-h-[100vh] flex justify-center items-center"},Yl={class:"max-w-fit flex-col shadow-lg bg-white rounded-lg px-5 pb-5"},zl={class:"mt-10"},$l=(0,n.Lk)("label",{for:"username"},"Логин",-1),Ql={class:"mt-10"},Gl=(0,n.Lk)("label",{for:"password"},"Пароль",-1),Hl={class:"flex justify-center mt-10"};var Jl=(0,n.pM)({__name:"Auth",setup(e){const a=(0,p.KR)(""),t=(0,p.KR)("");async function l(){if(a.value&&t.value&&!(0==a.value.length||a.value.length>128||0==t.value.length||t.value.length>128)){try{await w.A.post(k+"/auth/",{login:a.value,password:t.value}),console.log("authorize success")}catch(e){return void console.log("authorize failed")}console.log("load user data"),console.log("redirect to home"),await tn.push("/")}}return(e,s)=>((0,n.uX)(),(0,n.CE)("div",Ol,[(0,n.Lk)("div",Yl,[(0,n.Lk)("div",zl,[(0,n.bF)((0,p.R1)(Bl.A),null,{default:(0,n.k6)((()=>[(0,n.bF)((0,p.R1)($a.A),{id:"username",modelValue:a.value,"onUpdate:modelValue":s[0]||(s[0]=e=>a.value=e)},null,8,["modelValue"]),$l])),_:1})]),(0,n.Lk)("div",Ql,[(0,n.bF)((0,p.R1)(Bl.A),null,{default:(0,n.k6)((()=>[(0,n.bF)((0,p.R1)(Pl.A),{id:"password",modelValue:t.value,"onUpdate:modelValue":s[1]||(s[1]=e=>t.value=e),feedback:!1},null,8,["modelValue"]),Gl])),_:1})]),(0,n.Lk)("div",Hl,[(0,n.bF)((0,p.R1)(P.A),{label:"Войти",onClick:s[2]||(s[2]=e=>l())})])])]))}});const ql=Jl;var Zl=ql;const en=[{path:"/",name:"home",component:za},{path:"/auth/",name:"auth",component:Zl},{path:"/users/",name:"users",component:jl}],an=(0,c.aE)({history:(0,c.Bt)(),routes:en});var tn=an,ln=t(7440),nn=t(6922),sn=t(3676);w.A.defaults.withCredentials=!0,w.A.interceptors.response.use((e=>e),(e=>(console.log(e),e.response&&401===e.response.status&&tn.push("/auth"),Promise.reject(e))));const un=(0,l.Ef)(i);un.use(V),un.use(tn),un.use(ln.Ay,{theme:{preset:nn.A,options:{darkModeSelector:"light",prefix:"p",cssLayer:!1}}}),un.directive("dragscroll",sn.S),un.mount("#app")}},a={};function t(l){var n=a[l];if(void 0!==n)return n.exports;var s=a[l]={exports:{}};return e[l].call(s.exports,s,s.exports,t),s.exports}t.m=e,function(){var e=[];t.O=function(a,l,n,s){if(!l){var u=1/0;for(c=0;c<e.length;c++){l=e[c][0],n=e[c][1],s=e[c][2];for(var o=!0,r=0;r<l.length;r++)(!1&s||u>=s)&&Object.keys(t.O).every((function(e){return t.O[e](l[r])}))?l.splice(r--,1):(o=!1,s<u&&(u=s));if(o){e.splice(c--,1);var i=n();void 0!==i&&(a=i)}}return a}s=s||0;for(var c=e.length;c>0&&e[c-1][2]>s;c--)e[c]=e[c-1];e[c]=[l,n,s]}}(),function(){t.n=function(e){var a=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(a,{a:a}),a}}(),function(){t.d=function(e,a){for(var l in a)t.o(a,l)&&!t.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:a[l]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};t.O.j=function(a){return 0===e[a]};var a=function(a,l){var n,s,u=l[0],o=l[1],r=l[2],i=0;if(u.some((function(a){return 0!==e[a]}))){for(n in o)t.o(o,n)&&(t.m[n]=o[n]);if(r)var c=r(t)}for(a&&a(l);i<u.length;i++)s=u[i],t.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return t.O(c)},l=self["webpackChunkweb_fn"]=self["webpackChunkweb_fn"]||[];l.forEach(a.bind(null,0)),l.push=a.bind(null,l.push.bind(l))}();var l=t.O(void 0,[504],(function(){return t(2968)}));l=t.O(l)})();
//# sourceMappingURL=app.1179e635.js.map